library(CNVrdpermutation)
sessionInfo()
library(CNVrdpermutations)
 load("~/scratch/CNV_1000_Genomes/ped/test/chr10.Rdata")
objectCNVrd2
library(CNVrdpermutations)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000, nperm=2)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000, nperm=2)
unload("package:CNVrdpermutations", detach=T)
detach("package:CNVrdpermutations", unload=T)
library(CNVrdpermutations)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000, nperm=2)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000, nperm=2)
detach("package:CNVrdpermutations", unload=T)
detach("package:CNVrdpermutations", unload=T)
detach("package:CNVrdpermutations", unload=T)
detach("package:CNVrdpermutations", unload=T)
library(CNVrdpermutations)
a = permute_segmentation_results(segmented_samples$segmentResults, st=0, en=135534746, window_size=1000, nperm=2)
load(system.file("extdata", "testSegments.RData", package="CNVrdpermutations"))
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=5)
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=5)
a[1,]
a[2,]
a[3,]
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)/(ncol(a)* nrow(a))
sum(a > 0.1)/(ncol(a)* nrow(a))
sum(a > 0.3)/(ncol(a)* nrow(a))
getSubRegionMatrixFromSegmentScores(permute_list,window_size=1000,st=0,en=51304000)
s = getSubRegionMatrixFromSegmentScores(permute_list,window_size=1000,st=0,en=51304000)
s2 = apply(s,2,sd)
s2
s2 > 0.2
which(s2 > 0.2)
which(s2 > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=100)
sum(a > 0.3)/(ncol(a)* nrow(a))
sum(a > 0.2)/(ncol(a)* nrow(a))
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1000)
a
sum(a > 0.2)/(ncol(a)* nrow(a))
sum(a > 0.1)/(ncol(a)* nrow(a))
sum(a > 0.3)/(ncol(a)* nrow(a))
sum(a > 0.5)/(ncol(a)* nrow(a))
sum(s > 0.2)
sum(s > 0.2)/51304
sum(s > 0.2)/51304000
length(s)
sum(s > 0.2)/513040
s
s[1,]
s[2,]
2
s2
sum(s2 > 0.2)/513040
s2
s2 > 0.2
which(s2 > 0.2)
sum(s2 > 0.2)/513040
sum(s2 > 0.2)/51304
length(s2)
sum(s2 > 0.2)/51304
sum(s2 > 0.2)/51304
sum(s2 > 0.2)/51304
s > 0.2
sum(s > 0.2)
ncol(a)
ncol(a) * nrow(a)
348746/51304000
a > 0.2
sum(a > 0.2)
3567506/51304000
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
a
sum(a > 0.2)
sum(s2 > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=2)
sum(s2 > 0.2)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1000)
a > .02
sum(a > .2)
12384471 / (ncol(a) * nrow(a))
sum(a > .2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=10)
sum(a > 0.2)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1000)
save("Test.RData")
save.image(file="Test.RData")
y
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1000)
a[1,]
a[2,]
a[3,]
sum(a > 0.2)
ncol(a)  * nrow(a)
5253654/51304000
sum(s2)
sum(s2 > 10)
sum(s2 > 0.2)
sum(s2 > 0.2) / length(s2)
a[1,]
a[2,]
a[3,]
a[4,]
a[5,]
save.image(file="Test.RData")
51304 * 1000
permuteSample
permuteChromosome
chr = "chr20"
i = 1
st = 0
en = 51304000
windows = 1000
task = c(i, chr, st, en, window)
tasks
task
permuteChromosome
lapply(sample_list, permuteSample, st = st, windows = windows,
        randomize_start = T)
lapply(sample_list, permuteSample, st = st, windows = windows, random
lapply(sample_list, permuteSample, st = st, windows = windows, randomize_start=T)
lapply(permute_list , permuteSample, st = st, windows = windows, randomize_start=T)
lapply(permute_list , permuteSample, st = st, windows = windows, randomize_start=T)
lapply(permute_list , permuteSample, st = st, windows = windows, randomize_start=T)
lapply(permute_list , permuteSample, st = st, windows = windows, randomize_start=T)
lol = lapply(permute_list , permuteSample, st = st, windows = windows, randomize_start=T)
lol
w = getSubRegionMatrixFromSegmentScores(lol,window_size=1000,st=0,en=51304000)
apply(w,2,sd)
lel = apply(w,2,sd)
lel > 0.2
w = getSubRegionMatrixFromSegmentScores(lol,window_size=1000,st=0,en=5130)
w
w
w[1,]
w[1,]
w[2,]
w[3,]
w[4,]
w[,1]
lol
lol
permute_list
lol
permute_list
lol
permute_list
permute_list
lol
permute_list
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
a
a[,1]
a[1,]
a[1,]
a[1,]
a[1,]
lel
lel
lel
lel
w[1,]
lel = apply(w,2,sd)
w[,1]
w[,2]
w[,3]
w[,4]
w[,5]
w[,100]
w[,1000]
w[,10000]
w
w[1,]
w[1]
lel[1]
lel[2]
lel[3]
lel[4]
lel[5]
lel[6]
library(CNVrdpermutations)
library(CNVrdpermutations)
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
library(CNVrdpermutations)
a= permute_segmentation_results(permute_list,1000,0,51304000,nperm=1)
